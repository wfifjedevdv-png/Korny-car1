<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù…Ø¹Ø±Ø¶ Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª</title>

<style>
:root{
 --bg1:#05070c;
 --bg2:#0b0f17;
 --blue:#1e90ff;
 --glass:rgba(255,255,255,.1);
}

*{box-sizing:border-box;font-family:Segoe UI,Tahoma}

body{
 margin:0;
 min-height:100vh;
 background:linear-gradient(180deg,var(--bg1),var(--bg2));
 color:white;
}

header{
 padding:16px;
 display:flex;
 justify-content:space-between;
 align-items:center;
}

header h2{margin:0}

.logout{
 background:none;
 border:1px solid #3aa0ff;
 color:#3aa0ff;
 padding:6px 14px;
 border-radius:20px;
 cursor:pointer;
}

.container{
 max-width:1100px;
 margin:auto;
 padding:20px;
 display:grid;
 grid-template-columns:repeat(auto-fill,minmax(220px,1fr));
 gap:18px;
}

.card{
 background:var(--glass);
 backdrop-filter:blur(12px);
 border-radius:22px;
 overflow:hidden;
 cursor:pointer;
 transition:.25s;
}

.card:hover{
 transform:translateY(-6px);
 box-shadow:0 12px 30px rgba(0,0,0,.4);
}

.card img{
 width:100%;
 height:150px;
 object-fit:cover;
}

.card .info{
 padding:14px;
}

.card h4{
 margin:0 0 6px;
 font-size:16px;
}

.price{
 color:#3aa0ff;
 font-weight:bold;
}
</style>
</head>

<body>

<header>
 <h2>ğŸš— Ù…Ø¹Ø±Ø¶ Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª</h2>
 <button class="logout" onclick="logout()">Ø®Ø±ÙˆØ¬</button>
</header>

<div class="container" id="list"></div>

<!-- SUPABASE -->
<script type="module">
import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm";

/* ğŸ”‘ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ */
const SUPABASE_URL = "https://fquwikhishikbysnzqfd.supabase.co";
const SUPABASE_ANON_KEY = "sb_publishable_5MYNJ7ek_LaarRhPDBNODg_Yz-4qthG";
const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

/* Ø­Ù…Ø§ÙŠØ© */
const session = JSON.parse(localStorage.getItem("session"));
if(!session){
 location.href="index.html";
}

/* Ø¹Ù†Ø§ØµØ± */
const list = document.getElementById("list");

/* Ø¬Ù„Ø¨ Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª */
const { data:cars } = await supabase
 .from("cars")
 .select("*")
 .order("created_at",{ascending:false});

if(!cars || !cars.length){
 list.innerHTML = "<p style='opacity:.6'>ğŸš— Ù„Ø§ ØªÙˆØ¬Ø¯ Ø³ÙŠØ§Ø±Ø§Øª</p>";
}

/* Ø¹Ø±Ø¶ */
cars.forEach(car=>{
 list.innerHTML += `
  <div class="card" onclick="openCar(${car.id})">
   <img src="${car.img}">
   <div class="info">
    <h4>${car.name}</h4>
    <div class="price">${car.price}</div>
   </div>
  </div>
 `;
});

/* ÙØªØ­ Ø§Ù„ØªÙØ§ØµÙŠÙ„ */
window.openCar = function(id){
 location.href = "car.html?id=" + id;
}

/* Ø®Ø±ÙˆØ¬ */
window.logout = function(){
 localStorage.removeItem("session");
 location.href="index.html";
}
</script>

</body>
</html>
